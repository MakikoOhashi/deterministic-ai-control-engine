(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[931],{1736:function(e,t,n){Promise.resolve().then(n.bind(n,6774))},6774:function(e,t,n){"use strict";n.r(t),n.d(t,{default:function(){return s}});var r=n(7437),l=n(2265),i=n(6148),a=n(357);function s(){let e=(0,l.useMemo)(()=>a.env.NEXT_PUBLIC_API_BASE||"http://localhost:3001",[]),[t,n]=(0,l.useState)("Passage:\nUrban green spaces reduce heat and improve wellbeing, but funding remains limited.\n\nQuestion:\nWhat does the passage imply about funding for green spaces?\n\nChoices:\nA) It is adequate.\nB) It is limited.\nC) It is increasing rapidly.\nD) It is unrelated to wellbeing.\n\nAnswer: B"),[s,o]=(0,l.useState)(""),[c,u]=(0,l.useState)(""),[d,h]=(0,l.useState)([]),[f,m]=(0,l.useState)(null),[p,g]=(0,l.useState)(""),[v,y]=(0,l.useState)(null),[x,j]=(0,l.useState)(!1),[b,S]=(0,l.useState)(null),[w,T]=(0,l.useState)(null),[N,k]=(0,l.useState)(null),[C,A]=(0,l.useState)(null),[I,E]=(0,l.useState)(null),[R,B]=(0,l.useState)(.05),[L,_]=(0,l.useState)("fact_based"),[O,P]=(0,l.useState)({L:0,S:0,A:0,R:0}),[q,U]=(0,l.useState)(null),[G,M]=(0,l.useState)(!1),[W,D]=(0,l.useState)(null),[J,Q]=(0,l.useState)(null),[F,X]=(0,l.useState)(null),[Z,z]=(0,l.useState)(null),[H,K]=(0,l.useState)(null),[V,Y]=(0,l.useState)(null),[$,ee]=(0,l.useState)(null),[et,en]=(0,l.useState)(null);(0,l.useEffect)(()=>{fetch("".concat(e,"/difficulty/weights")).then(e=>e.json()).then(e=>S(e.weights)).catch(()=>S(null))},[e]);let er=e=>Math.max(0,Math.min(1,e)),el=(0,l.useMemo)(()=>w?{L:er(w.L+O.L),S:er(w.S+O.S),A:er(w.A+O.A),R:er(w.R+O.R)}:null,[w,O]),ei=async n=>{M(!0),D(null),Q(null);try{var r,l;let i=await fetch("".concat(e,"/target/from-sources-mc"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourceTexts:[(n||t).trim()].filter(Boolean)})});if(!i.ok){let e=await i.json();throw Error(e.error||"Request failed")}let a=await i.json();if(!a.ok)throw Error(a.error||"Target build failed");return T(a.mean),en((n||t).trim()),k(null!==(r=a.targetBand)&&void 0!==r?r:null),A(null!==(l=a.axisTolerance)&&void 0!==l?l:null),E(a.stability),B(a.effectiveTolerance),a.mean}catch(e){return D(e instanceof Error?e.message:"Unknown error"),o(""),u(""),h([]),m(null),g(""),k(null),A(null),y(null),null}finally{M(!1)}},ea=async(n,r)=>{M(!0),D(null);try{var l,i,a,s,c,d;let f=(r||t).trim(),p=await fetch("".concat(e,"/generate/mc"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({sourceText:f,target:null!==(i=null!=n?n:el)&&void 0!==i?i:w,inferenceStyle:L})});if(!p.ok){let e=await p.json();throw Error(e.error||"Request failed")}let v=await p.json();if(!v.ok)throw Error(v.error||"Generation failed");let x=v.item;o(x.passage||""),u(x.question),h(x.choices),m(x.correctIndex),g(x.choices[x.correctIndex]||""),X("number"==typeof v.similarity?v.similarity:null),Q(null!==(a=v.similarityWarning)&&void 0!==a?a:null),z(null!==(s=v.similarityBreakdown)&&void 0!==s?s:null),K(null!==(c=v.choiceIntent)&&void 0!==c?c:null),Y(null!==(d=v.choiceStructure)&&void 0!==d?d:null),ee({runId:v.runId,sourceId:v.sourceId,candidateId:v.candidateId,stage:null===(l=v.debug)||void 0===l?void 0:l.stage}),y(null),j(!1)}catch(e){D(e instanceof Error?e.message:"Unknown error"),X(null),Q(null),z(null),K(null),Y(null),ee(null)}finally{M(!1)}},es=async()=>{D(null),Q(null);try{let e=t.replace(/\r\n?/g,"\n").replace(/[ \t]+/g," ").replace(/\n{3,}/g,"\n\n").trim();if(e!==t&&n(e),!e)return;let r=e.trim();if(!w||!et||et!==r){let t=await ei(e);if(!t)return;await ea(t,e);return}await ea(null!=el?el:w,e)}catch(e){D(e instanceof Error?e.message:"Unknown error")}},eo=async()=>{if(D(null),Q(null),!w&&!el){D("Set target first.");return}await ea(null!=el?el:w,t)},ec=async()=>{M(!0),D(null);try{let t=await fetch("".concat(e,"/difficulty/overall"),{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({text:s?"".concat(s,"\n\n").concat(c):c,correct:null!=f&&d[f]?d[f]:"",distractors:null!=f?d.filter((e,t)=>t!==f):[],steps:2})});if(!t.ok){let e=await t.json();throw Error(e.error||"Request failed")}let n=await t.json();U(n)}catch(e){D(e instanceof Error?e.message:"Unknown error")}finally{M(!1)}},eu=null!=f&&d[f]?d[f]:"",ed=x&&v===eu;return[w&&q?q.components.A<w.A-.05?"Increase distractor similarity.":q.components.A>w.A+.05?"Reduce distractor similarity.":null:null,w&&q?q.components.S<w.S-.05?"Increase clause complexity.":q.components.S>w.S+.05?"Simplify sentence structure.":null:null].filter(Boolean),(0,r.jsxs)("main",{children:[(0,r.jsx)("h1",{children:"Stable Difficulty Generation Engine"}),(0,r.jsx)("div",{className:"subtitle",children:"Control-grade difficulty consistency for AI-generated assessments."}),(0,r.jsxs)("div",{className:"panel",children:[(0,r.jsxs)("div",{className:"mode-bar",children:[(0,r.jsx)("div",{className:"mode-title",children:"Task Type"}),(0,r.jsx)("div",{className:"mode-buttons",children:(0,r.jsx)("button",{className:"mode-button active",type:"button",children:"Guided Reading (v1)"})})]}),(0,r.jsx)("div",{className:"mode-note",children:"Read a passage and answer one inference question with 4 choices."}),(0,r.jsxs)("div",{className:"field",children:[(0,r.jsx)("label",{children:"Paste target example (1 passage and 1 question with 4 choices)"}),(0,r.jsx)("textarea",{value:t,onChange:e=>n(e.target.value),placeholder:"Passage:\n...\n\nQuestion:\n...\n\nChoices:\nA) ...\nB) ...\nC) ...\nD) ..."})]}),(0,r.jsxs)("div",{className:"field",children:[(0,r.jsx)("label",{children:"Inference Style"}),(0,r.jsxs)("select",{value:L,onChange:e=>_(e.target.value),style:{maxWidth:280},children:[(0,r.jsx)("option",{value:"fact_based",children:"Fact-based"}),(0,r.jsx)("option",{value:"intent_based",children:"Intent-based"}),(0,r.jsx)("option",{value:"emotional",children:"Emotional/Tone"})]})]}),(0,r.jsxs)("div",{className:"field",children:[(0,r.jsx)("label",{children:"Difficulty Target Adjust (L / S / A / R)"}),(0,r.jsx)("div",{style:{display:"grid",gridTemplateColumns:"1fr",gap:8},children:["L","S","A","R"].map(e=>(0,r.jsxs)("div",{style:{display:"grid",gridTemplateColumns:"28px 1fr 56px",gap:8,alignItems:"center"},children:[(0,r.jsx)("span",{children:e}),(0,r.jsx)("input",{type:"range",min:-.2,max:.2,step:.01,value:O[e],onChange:t=>P(n=>({...n,[e]:Number(t.target.value)}))}),(0,r.jsx)("span",{children:O[e].toFixed(2)})]},e))})]}),(0,r.jsxs)("div",{className:"actions",style:{marginTop:4},children:[(0,r.jsx)("button",{onClick:es,disabled:G,children:G?"Working...":"Generate"}),(0,r.jsx)("button",{onClick:eo,disabled:G||!w,children:G?"Working...":"Regenerate"})]}),(0,r.jsxs)("div",{className:"generated",children:[(0,r.jsx)("div",{className:"generated-title",children:"Generated Question"}),s?(0,r.jsx)("div",{className:"generated-text",children:s}):null,(0,r.jsx)("div",{className:"generated-text",children:c||"â€”"}),(0,r.jsx)("div",{className:"options",children:d.filter(Boolean).map(e=>(0,r.jsxs)("label",{className:"option",children:[(0,r.jsx)("input",{type:"radio",name:"answer",value:e,checked:v===e,onChange:()=>y(e)}),(0,r.jsx)("span",{children:e})]},e))}),(0,r.jsxs)("div",{className:"actions",children:[(0,r.jsx)("button",{onClick:()=>j(!0),disabled:!v,children:"Submit Answer"}),(0,r.jsx)("button",{onClick:ec,disabled:G,children:G?"Auditing...":"Run Audit"})]}),x?(0,r.jsx)("div",{className:ed?"result good":"result bad",children:ed?"Correct":"Correct answer: ".concat(eu)}):null]}),J?(0,r.jsx)("div",{className:"warning",style:{marginTop:12},children:J}):null,W?(0,r.jsx)("div",{className:"error",style:{marginTop:12},children:W}):null]}),(0,r.jsx)(i.Z,{result:q,target:w,targetBand:N,axisTolerance:C,weights:b,effectiveTolerance:R,stability:I,similarity:F,similarityBreakdown:Z,choiceIntent:H,choiceStructure:V,runMeta:$,error:W})]})}},357:function(e,t,n){"use strict";var r,l;e.exports=(null==(r=n.g.process)?void 0:r.env)&&"object"==typeof(null==(l=n.g.process)?void 0:l.env)?n.g.process:n(8081)},8081:function(e){!function(){var t={229:function(e){var t,n,r,l=e.exports={};function i(){throw Error("setTimeout has not been defined")}function a(){throw Error("clearTimeout has not been defined")}function s(e){if(t===setTimeout)return setTimeout(e,0);if((t===i||!t)&&setTimeout)return t=setTimeout,setTimeout(e,0);try{return t(e,0)}catch(n){try{return t.call(null,e,0)}catch(n){return t.call(this,e,0)}}}!function(){try{t="function"==typeof setTimeout?setTimeout:i}catch(e){t=i}try{n="function"==typeof clearTimeout?clearTimeout:a}catch(e){n=a}}();var o=[],c=!1,u=-1;function d(){c&&r&&(c=!1,r.length?o=r.concat(o):u=-1,o.length&&h())}function h(){if(!c){var e=s(d);c=!0;for(var t=o.length;t;){for(r=o,o=[];++u<t;)r&&r[u].run();u=-1,t=o.length}r=null,c=!1,function(e){if(n===clearTimeout)return clearTimeout(e);if((n===a||!n)&&clearTimeout)return n=clearTimeout,clearTimeout(e);try{n(e)}catch(t){try{return n.call(null,e)}catch(t){return n.call(this,e)}}}(e)}}function f(e,t){this.fun=e,this.array=t}function m(){}l.nextTick=function(e){var t=Array(arguments.length-1);if(arguments.length>1)for(var n=1;n<arguments.length;n++)t[n-1]=arguments[n];o.push(new f(e,t)),1!==o.length||c||s(h)},f.prototype.run=function(){this.fun.apply(null,this.array)},l.title="browser",l.browser=!0,l.env={},l.argv=[],l.version="",l.versions={},l.on=m,l.addListener=m,l.once=m,l.off=m,l.removeListener=m,l.removeAllListeners=m,l.emit=m,l.prependListener=m,l.prependOnceListener=m,l.listeners=function(e){return[]},l.binding=function(e){throw Error("process.binding is not supported")},l.cwd=function(){return"/"},l.chdir=function(e){throw Error("process.chdir is not supported")},l.umask=function(){return 0}}},n={};function r(e){var l=n[e];if(void 0!==l)return l.exports;var i=n[e]={exports:{}},a=!0;try{t[e](i,i.exports,r),a=!1}finally{a&&delete n[e]}return i.exports}r.ab="//";var l=r(229);e.exports=l}()}},function(e){e.O(0,[148,971,23,744],function(){return e(e.s=1736)}),_N_E=e.O()}]);